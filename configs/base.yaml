paths:
  scratch_dir: "/fs/scratch/PAS2836/lees_stuff"

model:
  name: "MCES10/maths-problems-gemma-2-2b-it"

latent:
  K: 8
  p_start: 0.9
  p_end: 0.0
  p_anneal_ratio: 0.8

training:
  batch_size_per_gpu: 16
  gradient_accumulation_steps: 1
  num_epochs: 5
  learning_rate: 2e-5
  weight_decay: 0.01
  warmup_ratio: 0.05
  max_grad_norm: 1.0
  bf16: true
  gradient_checkpointing: true

distributed:
  backend: "cuda"                          # "cuda" for GPU/NCCL/FSDP, "xla" for TPU/XLA FSDP
  fsdp: true
  fsdp_sharding_strategy: "FULL_SHARD"
  fsdp_wrap_policy: "transformer_layer"
  fsdp_cpu_offload: false
  fsdp_activation_checkpointing: true
  fsdp_mixed_precision: "bf16"

data:
  dataset: "SynthLabsAI/Big-Math-RL-Verified"
  max_question_tokens: 512
  max_answer_tokens: 64

eval:
  benchmarks: [gsm8k]
  eval_every_steps: 2000
  max_new_tokens: 64

logging:
  wandb_project: "latent-reasoning"
  log_every_steps: 10

checkpointing:
  save_dir: "./checkpoints"
  save_every_steps: 2000
  keep_last_n: 3
